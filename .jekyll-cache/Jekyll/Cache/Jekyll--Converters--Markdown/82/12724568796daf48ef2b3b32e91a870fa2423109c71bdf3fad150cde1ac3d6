I"¾a<p>itertoolsç®—å¾—ä¸Šæ˜¯Pythonä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒä¸»è¦æä¾›äº†æ“ä½œåœ¨å¯è¿­ä»£å¯¹è±¡ä¸Šçš„ä¸€äº›å®ç”¨å‡½æ•°ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»è¿™äº›å‡½æ•°çš„åŸºæœ¬ç­‰ä»·å®ç°ä¸ä¸€äº›ä½¿ç”¨å¿ƒå¾—.(Python Version:3.6.3)</p>

<h4 id="cycle">cycle</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">cycle</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
    <span class="c1"># cycle('ABCD') ---&gt; A B C D A B C D A B C D...
</span>    <span class="n">saved</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">item</span>
        <span class="n">saved</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">saved</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">saved</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">item</span>
</code></pre></div></div>
<p>ä½¿ç”¨ä¾‹å­ï¼šåŸºäºcycleå®ç°çš„Round-Robinè´Ÿè½½å‡è¡¡</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RoundRobinSelector</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hosts</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">hosts</span> <span class="o">=</span> <span class="n">hosts</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_it</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_it</span><span class="p">)</span>
</code></pre></div></div>
<p>ä¹‹å‰å»çŸ¥ä¹é¢è¯•ï¼Œè€ƒè¿‡æ‰‹å†™cycleçš„å®ç°ã€‚ã€‚ã€‚ã€‚å¦å¤–ï¼Œcycleä½¿ç”¨ä¸­æœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œå®ƒéœ€è¦é¢å¤–çš„ç©ºé—´æ¥å­˜å‚¨ï¼Œæ‰€ä»¥å½“è¾“å…¥é›†å¤ªå¤§æ—¶ï¼Œæœ€å¥½è‡ªå·±ç”¨å–æ¨¡å®ç°ç±»ä¼¼çš„åŠŸèƒ½</p>

<hr />

<h4 id="count">count</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># count(10) ---&gt; 0 1 2 3 4 5 6...
</span>    <span class="c1"># count(2.5, 0.5) ---&gt; 2.5 3 3.5...
</span>    <span class="n">n</span> <span class="o">=</span> <span class="n">start</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="n">step</span>
</code></pre></div></div>

<hr />

<h4 id="repeat">repeat</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">o</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">o</span>
</code></pre></div></div>

<p>ä½¿ç”¨ä¾‹å­ï¼š
    repeatå‡½æ•°ä¸»è¦ç”¨åœ¨ä¸€äº›éœ€è¦å¸¸é‡åºåˆ—çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªåºåˆ—æ±‚å¹³æ–¹â€”map(pow, range(5), repeat(2))</p>

<hr />

<h4 id="compress">compress</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">compress</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">selectors</span><span class="p">):</span>
    <span class="c1"># compress('ABCDED', [1, 0, 1, 0, 0, 0]) ---&gt; A C
</span>    <span class="k">return</span> <span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">selectors</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></div>
<hr />

<h4 id="filterfalse">filterfalse</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">filterfalse</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pred</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="nb">bool</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterable</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pred</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pred</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="nb">bool</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterable</span> <span class="k">if</span> <span class="n">pred</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
</code></pre></div></div>

<p>filterfalseé…åˆå†…ç½®å‡½æ•°filterå¯ç”¨äºå¯¹è¾“å…¥é›†é€šè¿‡è°“è¯(predicate)è¿›è¡Œåˆ†ç»„ï¼Œå¯¹å¾—åˆ°çš„åºåˆ—å¯ç”¨äºä¸åŒä¸šåŠ¡é€»è¾‘çš„å¤„ç†</p>

<hr />

<h4 id="takewhile">takewhile</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">takewhile</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pred</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
</code></pre></div></div>

<p>ç”¨äºå¾—åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å‰ç¼€åºåˆ—</p>

<hr />

<h4 id="dropwhile">dropwhile</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dropwhile</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
    <span class="c1"># dropwhile(lambda x: x &lt; 5, [1, 4, 6, 4, 1]) ---&gt; 6 4 1
</span>    <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pred</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">item</span>
            <span class="k">break</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">item</span>
</code></pre></div></div>
<p>ç”¨äºå¾—åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åç¼€åºåˆ—</p>

<hr />

<h4 id="chain">chain</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">chain</span><span class="p">(</span><span class="o">*</span><span class="n">iterables</span><span class="p">):</span>
    <span class="c1"># chain('ABC', 'DEF') --&gt; A B C D E F
</span>    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">iterables</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">element</span>
</code></pre></div></div>
<p>ç”¨äºå°†è¿ç»­çš„å¤šä¸ªåºåˆ—å½“æˆå•ä¸ªåºåˆ—å¤„ç†</p>

<hr />
<h4 id="chainfrom_iterable">chain.from_iterable</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">from_iterable</span><span class="p">(</span><span class="n">iterables</span><span class="p">):</span>
    <span class="c1"># chain.from_iterable(['ABC', 'DEF']) --&gt; A B C D E F
</span>    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">iterables</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">element</span>
</code></pre></div></div>

<p>è·Ÿchainç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œchain.from_iterableä¸ç”¨äº‹å…ˆçŸ¥é“iterablesçš„é•¿åº¦ï¼Œè€Œchainåˆ™éœ€è¦</p>

<hr />

<h4 id="islice">islice</h4>

<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">islice</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># islice('ABCDEFG', 2) --&gt; A B
</span>    <span class="c1"># islice('ABCDEFG', 2, 4) --&gt; C D
</span>    <span class="c1"># islice('ABCDEFG', 2, None) --&gt; C D E F G
</span>    <span class="c1"># islice('ABCDEFG', 0, None, 2) --&gt; A C E G
</span>    <span class="n">s</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="n">sys</span><span class="p">.</span><span class="n">maxsize</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">nexti</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nexti</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">element</span>
            <span class="n">nexti</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
</code></pre></div></div>
<p>è¯¥å‡½æ•°ä¸»è¦ä½œç”¨æœ‰å¦‚ä¸‹ä¸¤ä¸ªï¼š</p>

<ul>
  <li>
    <p>ä»ä¸€å®šç¨‹åº¦ä¸Šé¿å…äº†å¸¸è§„åˆ‡ç‰‡å¸¦æ¥çš„å†…å­˜å¤åˆ¶é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œåˆ‡ç‰‡çš„æ—¶é—´å¤æ‚åº¦å¢ä¸ºO(n)ï¼Œä½¿ç”¨æ—¶ï¼Œéœ€è¦è‡ªå·±æƒè¡¡ä¸€ä¸‹</p>
  </li>
  <li>
    <p>æä¾›äº†generatoråˆ‡ç‰‡ï¼Œä½†startã€stopå‚æ•°ä¸æ”¯æŒè´Ÿæ•°ï¼Œéœ€æ³¨æ„è¯¥é™åˆ¶</p>
  </li>
</ul>

<hr />

<h4 id="accumulate">accumulate</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">operator</span><span class="p">.</span><span class="n">add</span><span class="p">):</span>
    <span class="s">'Return running totals'</span>
    <span class="c1"># accumulate([1,2,3,4,5]) --&gt; 1 3 6 10 15
</span>    <span class="c1"># accumulate([1,2,3,4,5], operator.mul) --&gt; 1 2 6 24 120
</span>    <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">yield</span> <span class="n">total</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">total</span>
</code></pre></div></div>

<p>è¯¥å‡½æ•°ä¸functools.reduceç±»ä¼¼ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºï¼Œfunctools.reduceåªè¿”å›æœ€ç»ˆè®¡ç®—çš„å€¼ï¼Œè€Œaccumulateè¿”å›äº†æ¯æ­¥è®¡ç®—çš„å€¼ï¼Œé€šè¿‡accumulateå‡½æ•°ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—å‡ºå‰ç¼€ç›¸å…³çš„æ€§è´¨ï¼Œå¦‚å‰ç¼€å’Œã€å‰ç¼€ç§¯ã€å‰ç¼€æœ€å€¼ç­‰</p>

<hr />

<h4 id="zip_longest">zip_longest</h4>
<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ZipExhausted</span><span class="p">(</span><span class="nb">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">zip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="c1"># zip_longest('ABCD', 'xy', fillvalue='-') --&gt; ('A', 'x'), ('B', 'y'), ('C', '-'), ('D', '-')
</span>    <span class="n">fillvalue</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'fillvalue'</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">sentinel</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">counter</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">counter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ZipExhausted</span>
        <span class="n">counter</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">yield</span> <span class="n">fillvalue</span>
    <span class="n">fillers</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">fillvalue</span><span class="p">)</span>
    <span class="n">iterators</span> <span class="o">=</span> <span class="p">[</span><span class="n">chain</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">(),</span> <span class="n">fillers</span><span class="p">)</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">iterators</span><span class="p">:</span>
            <span class="k">yield</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">iterators</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ZipExhausted</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></div>
<p>å†…ç½®å‡½æ•°zipå½“å‚æ•°åºåˆ—é•¿åº¦ä¸ç­‰æ—¶ï¼Œé€‰æ‹©æœ€çŸ­åºåˆ—çš„é•¿åº¦åšä¸ºæœ€ç»ˆç»“æœçš„é•¿åº¦ï¼Œè€Œzip_longeståˆšå¥½ä¸å…¶ç›¸åï¼Œé€‰æ‹©æœ€é•¿åºåˆ—é•¿åº¦åšä¸ºæœ€ç»ˆç»“æœé•¿åº¦ï¼Œè€Œä¸åŠæœ€é•¿é•¿åº¦çš„åºåˆ—ï¼Œå¯é€šè¿‡fillvalueæŒ‡å®šå¡«å……å€¼</p>

<hr />

<h4 id="groupby">groupby</h4>

<p>åŸºæœ¬ç­‰ä»·å®ç°:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">groupby</span><span class="p">:</span>
    <span class="c1"># [k for k, g in groupby('AAAABBBCCDAABBB')] --&gt; A B C D A B
</span>    <span class="c1"># [list(g) for k, g in groupby('AAAABBBCCD')] --&gt; AAAA BBB CC D
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">keyfunc</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tgtkey</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">tgtkey</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">it</span><span class="p">)</span>    <span class="c1"># Exit on StopIteration
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">keyfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tgtkey</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">currkey</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">_grouper</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tgtkey</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">_grouper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tgtkey</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span> <span class="o">==</span> <span class="n">tgtkey</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">it</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">currkey</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">keyfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">currvalue</span><span class="p">)</span>
</code></pre></div></div>

<p>é€šè¿‡æŒ‡å®škeyå‡½æ•°ï¼Œå¯¹å¯è¿­ä»£å¯¹è±¡è¿›è¡Œåˆ†ç»„ï¼Œåˆ†ç»„çš„ä¾æ®ä¸ºç›¸é‚»å…ƒç´ æ˜¯å¦ç›¸ç­‰æ¥å†³å®šæ˜¯å¦å±äºåŒä¸€ä¸ªç»„ï¼Œè¿™ä¸SQLä¸­çš„Group Byå¤„ç†æ–¹å¼ä¸åŒï¼Œä½¿ç”¨æ—¶éœ€è¦é¢å¤–æ³¨æ„</p>

<h4 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h4>

<ul>
  <li><a href="https://docs.python.org/3.6/library/itertools.html">itertools</a></li>
</ul>
:ET